var en=Object.defineProperty;var tn=(e,t,r)=>t in e?en(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var kt=(e,t,r)=>(tn(e,typeof t!="symbol"?t+"":t,r),r),xt=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)};var he=(e,t,r)=>(xt(e,t,"read from private field"),r?r.call(e):t.get(e)),je=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},Ie=(e,t,r,n)=>(xt(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r);var rn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function su(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}),r}var Kt={exports:{}};(function(e,t){(function(r,n){n(e)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:rn,function(r){var n,o;if(!((o=(n=globalThis.chrome)==null?void 0:n.runtime)!=null&&o.id))throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser>"u"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const s="The message port closed before a response was received.",i=a=>{const l={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(l).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class u extends WeakMap{constructor(f,$=void 0){super($),this.createItem=f}get(f){return this.has(f)||this.set(f,this.createItem(f)),super.get(f)}}const m=p=>p&&typeof p=="object"&&typeof p.then=="function",g=(p,f)=>(...$)=>{a.runtime.lastError?p.reject(new Error(a.runtime.lastError.message)):f.singleCallbackArg||$.length<=1&&f.singleCallbackArg!==!1?p.resolve($[0]):p.resolve($)},x=p=>p==1?"argument":"arguments",O=(p,f)=>function(b,...P){if(P.length<f.minArgs)throw new Error(`Expected at least ${f.minArgs} ${x(f.minArgs)} for ${p}(), got ${P.length}`);if(P.length>f.maxArgs)throw new Error(`Expected at most ${f.maxArgs} ${x(f.maxArgs)} for ${p}(), got ${P.length}`);return new Promise((N,C)=>{if(f.fallbackToNoCallback)try{b[p](...P,g({resolve:N,reject:C},f))}catch(y){console.warn(`${p} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,y),b[p](...P),f.fallbackToNoCallback=!1,f.noCallback=!0,N()}else f.noCallback?(b[p](...P),N()):b[p](...P,g({resolve:N,reject:C},f))})},A=(p,f,$)=>new Proxy(f,{apply(b,P,N){return $.call(P,p,...N)}});let H=Function.call.bind(Object.prototype.hasOwnProperty);const _=(p,f={},$={})=>{let b=Object.create(null),P={has(C,y){return y in p||y in b},get(C,y,M){if(y in b)return b[y];if(!(y in p))return;let I=p[y];if(typeof I=="function")if(typeof f[y]=="function")I=A(p,p[y],f[y]);else if(H($,y)){let ie=O(y,$[y]);I=A(p,p[y],ie)}else I=I.bind(p);else if(typeof I=="object"&&I!==null&&(H(f,y)||H($,y)))I=_(I,f[y],$[y]);else if(H($,"*"))I=_(I,f[y],$["*"]);else return Object.defineProperty(b,y,{configurable:!0,enumerable:!0,get(){return p[y]},set(ie){p[y]=ie}}),I;return b[y]=I,I},set(C,y,M,I){return y in b?b[y]=M:p[y]=M,!0},defineProperty(C,y,M){return Reflect.defineProperty(b,y,M)},deleteProperty(C,y){return Reflect.deleteProperty(b,y)}},N=Object.create(p);return new Proxy(N,P)},G=p=>({addListener(f,$,...b){f.addListener(p.get($),...b)},hasListener(f,$){return f.hasListener(p.get($))},removeListener(f,$){f.removeListener(p.get($))}}),Xr=new u(p=>typeof p!="function"?p:function($){const b=_($,{},{getContent:{minArgs:0,maxArgs:0}});p(b)}),At=new u(p=>typeof p!="function"?p:function($,b,P){let N=!1,C,y=new Promise(ge=>{C=function(V){N=!0,ge(V)}}),M;try{M=p($,b,C)}catch(ge){M=Promise.reject(ge)}const I=M!==!0&&m(M);if(M!==!0&&!I&&!N)return!1;const ie=ge=>{ge.then(V=>{P(V)},V=>{let De;V&&(V instanceof Error||typeof V.message=="string")?De=V.message:De="An unexpected error occurred",P({__mozWebExtensionPolyfillReject__:!0,message:De})}).catch(V=>{console.error("Failed to send onMessage rejected reply",V)})};return ie(I?M:y),!0}),Qr=({reject:p,resolve:f},$)=>{a.runtime.lastError?a.runtime.lastError.message===s?f():p(new Error(a.runtime.lastError.message)):$&&$.__mozWebExtensionPolyfillReject__?p(new Error($.message)):f($)},bt=(p,f,$,...b)=>{if(b.length<f.minArgs)throw new Error(`Expected at least ${f.minArgs} ${x(f.minArgs)} for ${p}(), got ${b.length}`);if(b.length>f.maxArgs)throw new Error(`Expected at most ${f.maxArgs} ${x(f.maxArgs)} for ${p}(), got ${b.length}`);return new Promise((P,N)=>{const C=Qr.bind(null,{resolve:P,reject:N});b.push(C),$.sendMessage(...b)})},Yr={devtools:{network:{onRequestFinished:G(Xr)}},runtime:{onMessage:G(At),onMessageExternal:G(At),sendMessage:bt.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:bt.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},Ue={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return l.privacy={network:{"*":Ue},services:{"*":Ue},websites:{"*":Ue}},_(a,Yr,l)};r.exports=i(chrome)}else r.exports=globalThis.browser})})(Kt);var nn=Kt.exports;const re=Xe(nn);var Z=re;class on extends Error{constructor(t,r){super(t),this.name="AuthenticationError",this.originalError=r}}class sn extends Error{constructor(t){super(t),this.name="BookmarkSourceNotConfiguredError"}}class an extends Error{constructor(t,r){super(t),this.name="DataNotFoundError",this.originalError=r}}class Wt extends Error{constructor(t){super(t),this.name="BookmarksDataNotValidError"}}class cn extends Error{constructor(t,r){super(t),this.name="RepositoryNotFoundError",this.originalError=r}}const ln=[EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,globalThis.DOMException,globalThis.AssertionError,globalThis.SystemError].filter(Boolean).map(e=>[e.name,e]),un=new Map(ln);class Qe extends Error{constructor(r){super(Qe._prepareSuperMessage(r));kt(this,"name","NonError")}static _prepareSuperMessage(r){try{return JSON.stringify(r)}catch{return String(r)}}}const dn=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0},{property:"cause",enumerable:!1}],qe=new WeakSet,mn=e=>{qe.add(e);const t=e.toJSON();return qe.delete(e),t},Gt=e=>un.get(e)??Error,Ye=({from:e,seen:t,to:r,forceEnumerable:n,maxDepth:o,depth:s,useToJSON:i,serialize:a})=>{if(!r)if(Array.isArray(e))r=[];else if(!a&&Et(e)){const u=Gt(e.name);r=new u}else r={};if(t.push(e),s>=o)return r;if(i&&typeof e.toJSON=="function"&&!qe.has(e))return mn(e);const l=u=>Ye({from:u,seen:[...t],forceEnumerable:n,maxDepth:o,depth:s,useToJSON:i,serialize:a});for(const[u,m]of Object.entries(e)){if(typeof Buffer=="function"&&Buffer.isBuffer(m)){r[u]="[object Buffer]";continue}if(m!==null&&typeof m=="object"&&typeof m.pipe=="function"){r[u]="[object Stream]";continue}if(typeof m!="function"){if(!m||typeof m!="object"){try{r[u]=m}catch{}continue}if(!t.includes(e[u])){s++,r[u]=l(e[u]);continue}r[u]="[Circular]"}}for(const{property:u,enumerable:m}of dn)typeof e[u]<"u"&&e[u]!==null&&Object.defineProperty(r,u,{value:Et(e[u])?l(e[u]):e[u],enumerable:n?!0:m,configurable:!0,writable:!0});return r};function pn(e,t={}){const{maxDepth:r=Number.POSITIVE_INFINITY,useToJSON:n=!0}=t;return typeof e=="object"&&e!==null?Ye({from:e,seen:[],forceEnumerable:!0,maxDepth:r,depth:0,useToJSON:n,serialize:!0}):typeof e=="function"?`[Function: ${e.name||"anonymous"}]`:e}function fn(e,t={}){const{maxDepth:r=Number.POSITIVE_INFINITY}=t;if(e instanceof Error)return e;if(gn(e)){const n=Gt(e.name);return Ye({from:e,seen:[],to:new n,maxDepth:r,depth:0,serialize:!1})}return new Qe(e)}function Et(e){return!!e&&typeof e=="object"&&"name"in e&&"message"in e&&"stack"in e}function gn(e){return!!e&&typeof e=="object"&&"message"in e&&!Array.isArray(e)}var hn=Object.defineProperty,yn=Object.defineProperties,$n=Object.getOwnPropertyDescriptors,vt=Object.getOwnPropertySymbols,wn=Object.prototype.hasOwnProperty,An=Object.prototype.propertyIsEnumerable,jt=(e,t,r)=>t in e?hn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,It=(e,t)=>{for(var r in t||(t={}))wn.call(t,r)&&jt(e,r,t[r]);if(vt)for(var r of vt(t))An.call(t,r)&&jt(e,r,t[r]);return e},Pt=(e,t)=>yn(e,$n(t)),bn=(e,t,r)=>new Promise((n,o)=>{var s=l=>{try{a(r.next(l))}catch(u){o(u)}},i=l=>{try{a(r.throw(l))}catch(u){o(u)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(s,i);a((r=r.apply(e,t)).next())});function kn(e){let t,r={};function n(){Object.entries(r).length===0&&(t==null||t(),t=void 0)}let o=Math.floor(Math.random()*1e4);function s(){return o++}return{sendMessage(i,a,...l){return bn(this,null,function*(){var u,m;const g={id:s(),type:i,data:a,timestamp:Date.now()};(u=e.logger)==null||u.debug(`[messaging] sendMessage {id=${g.id}} ─ᐅ`,g,...l);const x=yield e.sendMessage(g,...l),{res:O,err:A}=x??{err:new Error("No response")};if((m=e.logger)==null||m.debug(`[messaging] sendMessage {id=${g.id}} ᐊ─`,{res:O,err:A}),A!=null)throw fn(A);return O})},onMessage(i,a){var l,u,m;if(t==null&&((l=e.logger)==null||l.debug(`[messaging] "${i}" initialized the message listener for this context`),t=e.addRootListener(g=>{var x,O;if(typeof g.type!="string"||typeof g.timestamp!="number"){const _=Error(`[messaging] Unknown message format, must include the 'type' & 'timestamp' fields, received: ${JSON.stringify(g)}`);throw(x=e.logger)==null||x.error(_),_}(O=e==null?void 0:e.logger)==null||O.debug("[messaging] Received message",g);const A=r[g.type];if(A==null)return;const H=A(g);return Promise.resolve(H).then(_=>{var G;return(G=e==null?void 0:e.logger)==null||G.debug(`[messaging] onMessage {id=${g.id}} ─ᐅ`,{res:_}),{res:_}}).catch(_=>{var G;return(G=e==null?void 0:e.logger)==null||G.debug(`[messaging] onMessage {id=${g.id}} ─ᐅ`,{err:_}),{err:pn(_)}})})),r[i]!=null){const g=Error(`[messaging] In this JS context, only one listener can be setup for ${i}`);throw(u=e.logger)==null||u.error(g),g}return r[i]=a,(m=e.logger)==null||m.log(`[messaging] Added listener for ${i}`),()=>{delete r[i],n()}},removeAllListeners(){Object.keys(r).forEach(i=>{delete r[i]}),n()}}}function xn(e){return kn(Pt(It({},e),{sendMessage(t,r){return r==null?re.runtime.sendMessage(t):re.tabs.sendMessage(r,t)},addRootListener(t){const r=(n,o)=>t(typeof n=="object"?Pt(It({},n),{sender:o}):n);return re.runtime.onMessage.addListener(r),()=>re.runtime.onMessage.removeListener(r)}}))}/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var En=function(t){return t!=null&&typeof t=="object"&&Array.isArray(t)===!1};/*!
 * get-value <https://github.com/jonschlinkert/get-value>
 *
 * Copyright (c) 2014-2018, Jon Schlinkert.
 * Released under the MIT License.
 */const Jt=En;var vn=function(e,t,r){if(Jt(r)||(r={default:r}),!Ot(e))return typeof r.default<"u"?r.default:e;typeof t=="number"&&(t=String(t));const n=Array.isArray(t),o=typeof t=="string",s=r.separator||".",i=r.joinChar||(typeof s=="string"?s:".");if(!o&&!n)return e;if(o&&t in e)return Be(t,e,r)?e[t]:r.default;let a=n?t:jn(t,s,r),l=a.length,u=0;do{let m=a[u];for(typeof m=="number"&&(m=String(m));m&&m.slice(-1)==="\\";)m=St([m.slice(0,-1),a[++u]||""],i,r);if(m in e){if(!Be(m,e,r))return r.default;e=e[m]}else{let g=!1,x=u+1;for(;x<l;)if(m=St([m,a[x++]],i,r),g=m in e){if(!Be(m,e,r))return r.default;e=e[m],u=x-1;break}if(!g)return r.default}}while(++u<l&&Ot(e));return u===l?e:r.default};function St(e,t,r){return typeof r.join=="function"?r.join(e):e[0]+t+e[1]}function jn(e,t,r){return typeof r.split=="function"?r.split(e):e.split(t)}function Be(e,t,r){return typeof r.isValid=="function"?r.isValid(e,t):!0}function Ot(e){return Jt(e)||Array.isArray(e)||typeof e=="function"}const In=Xe(vn);var Pn=(e,t,r)=>new Promise((n,o)=>{var s=l=>{try{a(r.next(l))}catch(u){o(u)}},i=l=>{try{a(r.throw(l))}catch(u){o(u)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(s,i);a((r=r.apply(e,t)).next())});function Sn(){if(!On())return!1;const e=re.runtime.getManifest();return e.background?e.manifest_version===3?_n():Rn():!1}function On(){var e;return!!((e=re.runtime)!=null&&e.id)}var Tn=["/_generated_background_page.html"];function Rn(){return typeof window<"u"&&Tn.includes(location.pathname)}function _n(){return typeof window>"u"}function Nn(e,t,r){let n;const o=`proxy-service.${e}`,{onMessage:s,sendMessage:i}=xn(r);function a(l){const u=()=>{},m=new Proxy(u,{apply(g,x,O){return Pn(this,null,function*(){return yield i(o,{path:l,args:O})})},get(g,x,O){return x==="__proxy"||typeof x=="symbol"?Reflect.get(g,x,O):a(l==null?x:`${l}.${x}`)}});return m.__proxy=!0,m}return[function(...u){return n=t(...u),s(o,({data:m})=>{const g=m.path==null?n:In(n??{},m.path);if(g)return Promise.resolve(g.bind(n)(...m.args))}),n},function(){if(!Sn())return a();if(n==null)throw Error(`Failed to get an instance of ${e}: in background, but registerService has not been called. Did you forget to call registerService?`);return n}]}const Oe="[a-fA-F0-9]",me="[a-zA-Z0-9-._~]",z="[!$&'()*+,;=]",oe=`%${Oe}${Oe}`,Pe="(?:\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])",et=`${Pe}\\.${Pe}\\.${Pe}\\.${Pe}`,v=`${Oe}{1,4}`,te=`(?:${v}:${v}|${et})`,Fn=`(?:(?:${v}:){6}${te}|::(?:${v}:){5}${te}|(?:${v})?::(?:${v}:){4}${te}|(?:(?:${v}:){0,1}${v})?::(?:${v}:){3}${te}|(?:(?:${v}:){0,2}${v})?::(?:${v}:){2}${te}|(?:(?:${v}:){0,3}${v})?::(?:${v}:){1}${te}|(?:(?:${v}:){0,4}${v})?::${te}|(?:(?:${v}:){0,5}${v})?::${v}|(?:(?:${v}:){0,6}${v})?::)`,Cn=`v${Oe}+\\.(?:${me}|${z}|:)+`,Ht=`\\[(?:${Fn}|${Cn})\\]`,pe="(?<scheme>[a-zA-Z][a-zA-Z0-9-+.]*)",Zt=":(?<port>\\d*)",Mn=`(?:${me}|${oe}|${z})*?`,Un=`(?<host>${Ht}|${et}|${Mn})`,Dn=`(?<userinfo>(?:${me}|${oe}|${z}|:)*)`,tt=`(?:${me}|${oe}|${z}|:|@)`,Xt=`${tt}*?`,Qt=`(?:/${Xt})*`,rt=`(?<authority>(?:${Dn}@)?${Un}(?:${Zt})?)`,nt=`(?<path>${Qt})`,ot=`(?<path2>${Xt}${Qt})`,st=`(?:\\?(?<query>(?:${tt}|/|\\?)*))?`,Yt=`(?:#(?<fragment>(?:${tt}|/|\\?)*))?`,er=`^${pe}:(?://${rt}${nt}|${ot})${st}${Yt}$`,tr=`^(?:${pe}:|)(?://${rt}${nt}|${ot})${st}${Yt}$`,rr=`^${pe}:(?://${rt}${nt}|${ot})${st}$`,Ee="[a-zA-Z0-9-._~\\00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF\\u10000-\\u1FFFD\\u20000-\\u2FFFD\\u30000-\\u3FFFD\\u40000-\\u4FFFD\\u50000-\\u5FFFD\\u60000-\\u6FFFD\\u70000-\\u7FFFD\\u80000-\\u8FFFD\\u90000-\\u9FFFD\\uA0000-\\uAFFFD\\uB0000-\\uBFFFD\\uC0000-\\uCFFFD\\uD0000-\\uDFFFD\\uE1000-\\uEFFFD]",Bn="[\\uE000-\\uF8FF\\uF0000-\\uFFFFD\\u100000-\\u10FFFD]",Ln=`(?:${Ee}|${oe}|${z})*?`,qn=`(?<host>${Ht}|${et}|${Ln})`,zn=`(?<userinfo>(?:${Ee}|${oe}|${z}|:)*)`,it=`(?:${Ee}|${oe}|${z}|:|@)`,nr=`${it}*?`,or=`(?:/${nr})*`,at=`(?<authority>(?:${zn}@)?${qn}(?:${Zt})?)`,ct=`(?<path>${or})`,lt=`(?<path2>${nr}${or})`,ut=`(?:\\?(?<query>(?:${it}|${Bn}|/|\\?)*))?`,sr=`(?:#(?<fragment>(?:${it}|/|\\?)*))?`,ir=`^${pe}:(?://${at}${ct}|${lt})${ut}${sr}$`,ar=`^(?:${pe}:|)(?://${at}${ct}|${lt})${ut}${sr}$`,cr=`^${pe}:(?://${at}${ct}|${lt})${ut}$`,Vn=e=>(t,r)=>{const n=e.parseReference(t);if(n.scheme===void 0){const o=e.parseAbsolute(r);n.scheme=o.scheme,n.authority===void 0&&(n.authority=o.authority,n.path===""?(n.path=o.path,n.query===void 0&&(n.query=o.query)):n.path.startsWith("/")||(n.path=Kn(n.path,o)))}return lr(e,n)},Kn=(e,t)=>{if(t.authority&&t.path==="")return"/"+e;{const r=t.path.lastIndexOf("/");return r===-1?e:t.path.slice(0,r+1)+e}},Wn=/^\.?\.\/|^\.\.?$/,Gn=/^\/\.(?:\/|$)/,Jn=/^\/\.\.(?:\/|$)/,Hn=e=>{let t="";for(;e.length>0;)if(Wn.test(e))e=Tt(e);else if(Gn.test(e))e=Rt(e);else if(Jn.test(e))e=Rt(e),t=Zn(t);else{const r=Xn(e);e=Tt(e),t+=r}return t},Tt=e=>{const t=e.indexOf("/",1);return t===-1?"":"/"+e.slice(t+1)},Rt=e=>{const t=e.indexOf("/",1);return t===-1?"/":"/"+e.slice(t+1)},Zn=e=>{const t=e.lastIndexOf("/");return t===-1?e:e.slice(0,t)},Xn=e=>{const t=e.indexOf("/",1);return t===-1?e:e.slice(0,t)},lr=(e,t)=>{let r=t.scheme.toLowerCase()+":";return r+=t.authority===void 0?"":"//"+t.authority.toLowerCase(),r+=e.normalizePath(t.path),r+=t.query===void 0?"":"?"+e.normalizeQuery(t.query),r+=t.fragment===void 0?"":"#"+e.normalizeFragment(t.fragment),r},ur=new RegExp(oe,"g"),dr=e=>t=>{const r=parseInt(t.slice(1),16),n=String.fromCharCode(r);return e(n)?n:t.toUpperCase()},Qn=RegExp.prototype.test.bind(new RegExp(`${me}|${z}|[:@]`)),Yn=RegExp.prototype.test.bind(new RegExp(`${Ee}|${z}|[:@]`)),_t=e=>t=>Hn(t).replaceAll(ur,dr(e)),Nt=RegExp.prototype.test.bind(new RegExp(`${me}|${z}|[:@/?]`)),Ft=RegExp.prototype.test.bind(new RegExp(`${Ee}|${z}|[:@/?]`)),Se=e=>t=>t.replaceAll(ur,dr(e));RegExp.prototype.test.bind(new RegExp(er));RegExp.prototype.test.bind(new RegExp(tr));RegExp.prototype.test.bind(new RegExp(rr));RegExp.prototype.test.bind(new RegExp(ir));RegExp.prototype.test.bind(new RegExp(ar));RegExp.prototype.test.bind(new RegExp(cr));const fe=(e,t)=>r=>{const n=e.exec(r);if(n===null)throw Error(`Invalid ${t}: ${r}`);return n.groups.authority===void 0&&(n.groups.path=n.groups.path2),delete n.groups.path2,n.groups},eo=fe(new RegExp(er),"URI"),to=fe(new RegExp(tr),"URI-reference"),ro=fe(new RegExp(rr),"absolute-URI"),mr=fe(new RegExp(ir),"IRI"),dt=fe(new RegExp(ar),"IRI-reference"),no=fe(new RegExp(cr),"absolute-IRI"),pr={uri:{parseAbsolute:ro,parseReference:to,parse:eo,normalizePath:_t(Qn),normalizeQuery:Se(Nt),normalizeFragment:Se(Nt)},iri:{parseAbsolute:no,parseReference:dt,parse:mr,normalizePath:_t(Yn),normalizeQuery:Se(Ft),normalizeFragment:Se(Ft)}},oo=e=>t=>{const r=e.parse(t);return delete r.fragment,lr(e,r)},X=oo(pr.iri),we=Vn(pr.iri);var L=so;function so(e,t){return function r(){t==null&&(t=e.length);var n=[].slice.call(arguments);return n.length>=t?e.apply(this,n):function(){return r.apply(this,n.concat([].slice.call(arguments)))}}}const io="",fr=Symbol("EXISTS"),ao=e=>{if(e.length>0&&e[0]!=="/")throw Error("Invalid JSON Pointer");let t=1,r=0;return n=>{if(n===fr)return r<e.length;if(r>=e.length)return;const o=e.indexOf("/",t);r=o===-1?e.length:o;const s=uo(e.slice(t,r));return t=r+1,s}},co=(e,t=void 0)=>{const r=ao(e),n=o=>gr(r,o,io);return t===void 0?n:n(t)},gr=(e,t,r)=>{if(e(fr)){const n=e();return gr(e,po(t,n,r),ue(n,r))}else return t},ue=L((e,t)=>t+"/"+lo(e)),lo=e=>e.toString().replace(/~/g,"~0").replace(/\//g,"~1"),uo=e=>e.toString().replace(/~1/g,"/").replace(/~0/g,"~"),mo=(e,t)=>Array.isArray(e)&&t==="-"?e.length:t,po=(e,t,r="")=>{if(e===void 0)throw TypeError(`Value at '${r}' is undefined and does not have property '${t}'`);if(e===null)throw TypeError(`Value at '${r}' is null and does not have property '${t}'`);if(fo(e))throw TypeError(`Value at '${r}' is a ${typeof e} and does not have property '${t}'`);{const n=mo(e,t);return e[n]}},fo=e=>e===null||typeof e!="object",mt=e=>{const t=typeof e;switch(t){case"number":case"string":case"boolean":case"undefined":return t;case"object":if(Array.isArray(e))return"array";if(e===null)return"null";if(Object.getPrototypeOf(e)===Object.prototype)return"object";default:const r=t==="object"?Object.getPrototypeOf(e).constructor.name||"anonymous":t;throw Error(`Not a JSON compatible type: ${r}`)}},hr=e=>{const t=e.indexOf("#"),r=t===-1?e.length:t;return e.slice(0,r)},go=e=>decodeURIComponent(dt(e).fragment||""),Te={},Ce=e=>{if(e.indexOf("#")!==-1){const t=hr(e);return{...Te[t],id:e}}return Te[e]},ho=(e,t)=>{const r=$o(e,t);if(!r)throw Error(`Encountered unknown keyword '${e}'`);const n=Ce(r);if(!n)throw Error(`Encountered unsupported keyword ${e}. You can provide an implementation for the '${r}' keyword using the 'addKeyword' function.`);return n},d=e=>{Te[e.id]=e},ze={},yo=(e,t)=>{ze[e]=t},$e={},yr={},$o=(e,t)=>{var r;return((r=$r(t))==null?void 0:r[e])||(yr[t]||e.startsWith("x-"))&&`https://json-schema.org/keyword/unknown#${e}`},j=(e,t)=>{const r=$r(e);for(const n in r)if(r[n]===t)return n},$r=e=>{if(!(e in $e))throw Error(`Encountered unknown dialect '${e}'`);return $e[e]},wr=(e,t,r=!1)=>{yr[e]=r,$e[e]={},Object.entries(t).forEach(([n,o])=>{if(n in ze)Object.entries(ze[n]).forEach(([s,i])=>{!(i in Te)&&!o&&(i=`https://json-schema.org/keyword/unknown#${s}`),$e[e][s]=i});else if(!r||o)throw delete $e[e],Error(`Unrecognized vocabulary: ${n}. You can define this vocabulary with the 'defineVocabulary' function.`)})};var pt={};/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var Ct=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,wo=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,Ar=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,Ao=/\\([\u000b\u0020-\u00ff])/g,bo=/([\\"])/g,br=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;pt.format=xo;var ko=pt.parse=Eo;function xo(e){if(!e||typeof e!="object")throw new TypeError("argument obj is required");var t=e.parameters,r=e.type;if(!r||!br.test(r))throw new TypeError("invalid type");var n=r;if(t&&typeof t=="object")for(var o,s=Object.keys(t).sort(),i=0;i<s.length;i++){if(o=s[i],!Ar.test(o))throw new TypeError("invalid parameter name");n+="; "+o+"="+jo(t[o])}return n}function Eo(e){if(!e)throw new TypeError("argument string is required");var t=typeof e=="object"?vo(e):e;if(typeof t!="string")throw new TypeError("argument string is required to be a string");var r=t.indexOf(";"),n=r!==-1?t.slice(0,r).trim():t.trim();if(!br.test(n))throw new TypeError("invalid media type");var o=new Io(n.toLowerCase());if(r!==-1){var s,i,a;for(Ct.lastIndex=r;i=Ct.exec(t);){if(i.index!==r)throw new TypeError("invalid parameter format");r+=i[0].length,s=i[1].toLowerCase(),a=i[2],a.charCodeAt(0)===34&&(a=a.slice(1,-1),a.indexOf("\\")!==-1&&(a=a.replace(Ao,"$1"))),o.parameters[s]=a}if(r!==t.length)throw new TypeError("invalid parameter format")}return o}function vo(e){var t;if(typeof e.getHeader=="function"?t=e.getHeader("content-type"):typeof e.headers=="object"&&(t=e.headers&&e.headers["content-type"]),typeof t!="string")throw new TypeError("content-type header is missing from object");return t}function jo(e){var t=String(e);if(Ar.test(t))return t;if(t.length>0&&!wo.test(t))throw new TypeError("invalid parameter value");return'"'+t.replace(bo,"\\$1")+'"'}function Io(e){this.parameters=Object.create(null),this.type=e}const Ae={},kr=(e,t)=>{Ae[e]=t},Po=e=>{const t=e.headers.get("content-type");if(t===null)throw new To("The media type of the response could not be determined. Make sure the response includes a 'Content-Type' header.",{cause:e});const r=ko(t);if(!(r.type in Ae))throw new Oo(r.type,`'${r.type}' is not supported. Use the 'addMediaTypePlugin' function to add support for this media type.`,{cause:e});return Ae[r.type].parse(e)},So=()=>{let e="";for(const t in Ae)e=Mt(e,t,Ae[t].quality);return Mt(e,"*/*","0.001")},Mt=(e,t,r)=>(e.length>0&&(e+=", "),e+=t,r&&(e+=`; q=${r}`),e);class Oo extends Error{constructor(t,r=void 0){super(r),this.name=this.constructor.name,this.mediaType=t}}class To extends Error{constructor(t=void 0){super(t),this.name=this.constructor.name}}const Ro=(e,t=void 0)=>JSON.parse(e,(r,n)=>{const o=n!==null&&typeof n.$ref=="string"?new ne(n.$ref):n;return t?t(r,o):o});var ke,xe;class ne{constructor(t,r=void 0){je(this,ke,void 0);je(this,xe,void 0);Ie(this,ke,t),Ie(this,xe,r??{$ref:t})}get href(){return he(this,ke)}toJSON(){return he(this,xe)}}ke=new WeakMap,xe=new WeakMap;const xr=e=>{const t=typeof e;switch(t){case"bigint":return"number";case"number":case"string":case"boolean":case"undefined":return t;case"object":if(e instanceof ne)return"reference";if(Array.isArray(e))return"array";if(e===null)return"null";if(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)return"object";default:const r=t==="object"?Object.getPrototypeOf(e).constructor.name||"anonymous":t;throw Error(`Not a JRef compatible type: ${r}`)}},_o={parse:async e=>({baseUri:e.url,root:Ro(await e.text()),anchorLocation:No}),fileMatcher:e=>e.endsWith(".jref")},No=e=>decodeURI(e||""),Ve={},Er=(e,t)=>{Ve[e]=t},Fo=(e,t)=>{e=we(e,t);const{scheme:r}=dt(e);if(!(r in Ve))throw new Co(r,`The '${r}:' URI scheme is not supported. Use the 'addUriSchemePlugin' function to add support for '${r}:' URIs.`);return Ve[r].retrieve(e,t)};class Co extends Error{constructor(t,r=void 0){super(r),this.name=this.constructor.name,this.scheme=t}}const Mo=new Set([200,203]),Uo=async e=>{const t=await fetch(e,{headers:{Accept:So()}});if(t.status>=400)throw new Ut(t,`Failed to retrieve '${e}'`);if(!Mo.has(t.status))throw new Ut(t,"Unsupported HTTP response status code");return t},vr={retrieve:Uo};class Ut extends Error{constructor(t,r=void 0){super(`${t.status} ${t.statusText}${r?` -- ${r}`:""}`),this.name=this.constructor.name,this.response=t}}const Do=()=>{var e,t;return((t=(e=globalThis.document)==null?void 0:e.location)==null?void 0:t.toString())??""},ft=async(e,t={_cache:{}})=>{var i,a,l;const r=((i=t.document)==null?void 0:i.baseUri)??Do();e=we(e,r);const n=X(e),{fragment:o}=mr(e),s=t._cache[n]??((l=(a=t.document)==null?void 0:a.embedded)==null?void 0:l[n]);if(s)t.document=s,t.uri=e,t.cursor=t.document.anchorLocation(o);else{try{const u=await Fo(e,r);t.document=await Po(u),t.uri=u.url+(o===void 0?"":`#${o}`),t.cursor=t.document.anchorLocation(o)}catch(u){const m=t.uri?` Referenced from '${t.uri}'.`:"";throw new Lo(`Unable to load resource '${e}'.${m}`,u)}t._cache[n]=t.document}return t._value=co(t.cursor,t.document.root),jr(t)},jr=e=>xr(w(e))==="reference"?ft(w(e).href,e):e,w=e=>e._value,U=e=>xr(e._value),Ir=(e,t)=>e in t._value,gt=e=>e._value.length,D=L((e,t)=>jr({...t,cursor:ue(`${e}`,t.cursor),_value:t._value[e]})),J=async function*(e){for(let t=0;t<w(e).length;t++)yield D(t,e)},Ke=function*(e){for(const t in w(e))yield t},Bo=async function*(e){for(const t in w(e))yield D(t,e)},Q=async function*(e){for(const t in w(e))yield[t,await D(t,e)]};class Lo extends Error{constructor(t,r){super(t,{cause:r}),this.name=this.constructor.name}}kr("application/reference+json",_o);Er("http",vr);Er("https",vr);const qo={parse:async e=>{const t=pt.parse(e.headers.get("content-type")??""),r=t.parameters.schema??t.parameters.profile;return _e(await e.json(),e.url,r)},fileMatcher:e=>/(\.|\/)schema\.json$/.test(e)},Re={},Pr=async(e,t=void 0)=>{if(!t){t={_cache:{}};for(const n in Re)t._cache[n]=Re[n]}const r=await ft(e,t);if(typeof r.document.dialectId!="string")throw Error(`The document at ${r.document.baseUri} is not a schema.`);return r},Sr=(e,t,r)=>{e=structuredClone(e);const n=_e(e,t,r);if(n.baseUri in Re)throw Error(`A schema has already been registered for '${n.baseUri}. You can use 'unregisterSchema' to remove the old schema before registering the new one.`);if(n.baseUri.startsWith("file:"))throw Error(`Registering a schema with a 'file:' URI scheme is not allowed: ${n.baseUri}`);Re[t?X(t):n.baseUri]=n},_e=(e,t,r,n={})=>{if(typeof e.$schema=="string"&&(r=e.$schema,delete e.$schema),!r)throw Error("Unable to determine a dialect for the schema. The dialect can be declared in a number of ways, but the recommended way is to use the '$schema' keyword in your schema.");r=X(r);const o=j(r,"https://json-schema.org/keyword/draft-04/id"),s=j(r,"https://json-schema.org/keyword/id")||o;if(!e[s]&&!t)throw Error(`Unable to determine an identifier for the schema. Use the '${s}' keyword or pass a retrievalUri when loading the schema.`);const i=we(e[s]??"",t??"");t=X(i),o&&i.length>t.length?e[s]="#"+go(i):delete e[s];const a=j(r,"https://json-schema.org/keyword/vocabulary");if(mt(e[a])==="object"){const g=e[a]["https://json-schema.org/draft/2019-09/vocab/core"]||e[a]["https://json-schema.org/draft/2020-12/vocab/core"];wr(t,e[a],g),delete e[a]}const l={"":""},u={},m=j(r,"https://json-schema.org/keyword/draft-2019-09/recursiveAnchor");return e[m]===!0&&(u[""]=`${t}#`),delete e[m],n[t]={baseUri:t,dialectId:r,root:We(e,t,r,"",n,l,u),anchorLocation:g=>{if(g===void 0)return"";if(g=decodeURI(g),g[0]==="/")return g;if(g in l)return l[g];throw Error(`No such anchor '${t}#${encodeURI(g)}'`)},anchors:l,dynamicAnchors:u,embedded:n},n[t]},We=(e,t,r,n,o,s,i)=>{if(mt(e)==="object"){const a=typeof e.$schema=="string"?X(e.$schema):r,l=j(a,"https://json-schema.org/keyword/id");if(typeof e[l]=="string"){const A=X(we(e[l],t));return e[l]=A,o[A]=_e(e,A,a,o),new ne(A,{})}const u=j(a,"https://json-schema.org/keyword/draft-04/id");if(typeof e[u]=="string")if(e[u][0]==="#"){const A=decodeURIComponent(e[u].slice(1));s[A]=n,delete e[u]}else{const A=X(we(e[u],t));return e[u]=A,o[A]=_e(e,A,a,o),new ne(A,{})}const m=j(r,"https://json-schema.org/keyword/draft-04/ref");if(typeof e[m]=="string")return new ne(e[m],e);const g=j(r,"https://json-schema.org/keyword/anchor");typeof e[g]=="string"&&(s[e[g]]=n,delete e[g]);const x=j(r,"https://json-schema.org/keyword/dynamicAnchor");typeof e[x]=="string"&&(i[e[x]]=`${t}#${encodeURI(n)}`,delete e[x]);const O=j(r,"https://json-schema.org/keyword/draft-2020-12/dynamicAnchor");typeof e[O]=="string"&&(i[e[O]]=`${t}#${encodeURI(n)}`,s[e[O]]=n,delete e[O]);for(const A in e){const H=j(r,"https://json-schema.org/keyword/ref");A===H&&typeof e[A]=="string"?e[A]=new ne(e[A],e[A]):e[A]=We(e[A],t,r,ue(A,n),o,s,i)}}else if(Array.isArray(e))for(let a=0;a<e.length;a++)e[a]=We(e[a],t,r,ue(a,n),o,s,i);return e},be=e=>`${e.document.baseUri}#${encodeURI(e.cursor)}`,Or=L(function*(e,t){for(const r of t)yield e(r)}),S=L(async function*(e,t){for await(const r of t)yield e(r)}),se=L(function*(e,t){for(const r of t)e(r)&&(yield r)}),Tr=L(function*(e,t){let r=0;for(const n of t)r++>=e&&(yield n)}),Rr=L(function*(e,t){var o;const r=Nr(t);let n;for(;e-- >0&&!((o=n=r.next())!=null&&o.done);)yield n.value}),zo=e=>{const r=Nr(e).next();return r.done?void 0:r.value},Ne=function*(e,t){for(let r=e;r<t||t===void 0;r++)yield r},Dt=function*(){},Me=function*(e,t){for(const r of e)yield[r,t.next().value]},Vo=function*(...e){for(const t of e)yield*t},_r=L((e,t,r)=>{for(const n of r)t=e(t,n);return t}),q=L((e,t)=>{for(const r of t)if(!e(r))return!1;return!0}),Ko=L((e,t)=>{for(const r of t)if(e(r))return!0;return!1}),F=async e=>{const t=[];for await(const r of e)t.push(r);return t},Ge=e=>{const t=new Set;for(const r of e)t.add(r);return t},Je=async e=>{const t=Object.create(null);for await(const[r,n]of e)t[r]=n;return t},Wo=L((e,t)=>{let r=zo(t)||"";for(const n of t)r+=e+n;return r}),Nr=e=>{if(typeof(e==null?void 0:e[Symbol.iterator])=="function")return e[Symbol.iterator]();throw TypeError("`iter` is not iterable")},k=(e,...t)=>_r((r,n)=>n(r),e,t),Go={id:void 0,pointer:"",instance:void 0,value:void 0},ht=(e,t=void 0)=>({...Go,id:t?X(t):"",instance:e,value:e}),Bt=e=>`${e.id||""}#${encodeURI(e.pointer)}`,E=e=>e.value instanceof ne?e.value.toJSON():e.value,de=(e,t)=>e in E(t),h=e=>mt(E(e)),Fr=(e,t)=>({...t,pointer:ue(e,t.pointer),value:E(t)[e]}),W=function*(e){for(let t=0;t<E(e).length;t++)yield Fr(t,e)},yt=function*(e){for(const t in E(e))yield t},Y=function*(e){for(const t in E(e))yield[t,Fr(t,e)]},ee=e=>E(e).length,K={};let Jo=0;const Cr=(e,t)=>{e in K||(K[e]={});const r=`pubsub_subscription_${Jo++}`;return K[e][r]=t,r},Ho=(e,t)=>{delete K[e][t]},ae=(e,t)=>{for(const r in K)if(r===e||e.startsWith(`${r}.`))for(const n in K[r])K[r][n](e,t)},Zo=async(e,t)=>{const r=[];for(const n in K)if(n===e||e.startsWith(`${n}.`))for(const o in K[n])r.push(K[e][o](e,t));await Promise.all(r)};let Mr;const Xo=()=>Mr,Qo=e=>{Mr=e};class Yo extends Error{constructor(t){super("Invalid Schema"),this.name=this.constructor.name,this.output=t}}const Ur="https://json-schema.org/evaluation/validate",es=async(e,t)=>{await Zo("validate.metaValidate",e),e.document.baseUri in t.metaData||(t.metaData[e.document.baseUri]={dynamicAnchors:e.document.dynamicAnchors});const r=be(e);if(!(r in t)){t[r]=!1;const n=w(e);if(!["object","boolean"].includes(typeof n))throw Error(`No schema found at '${r}'`);t[r]=typeof n=="boolean"?n:await k(Q(e),S(async([o,s])=>{const i=ho(o,e.document.dialectId),a=await i.compile(s,t,e);return[i.id,ue(o,be(e)),a]}),F)}return r},ts=(e,t,r,n,o=!1)=>{n={...r.metaData[hr(e)].dynamicAnchors,...n},!o&&ae("result.start");const s=typeof r[e]=="boolean"?r[e]:r[e].every(([i,a,l])=>{!o&&ae("result.start");const u=Ce(i).interpret(l,t,r,n,o);return!o&&ae("result",{keyword:i,absoluteKeywordLocation:a,instanceLocation:Bt(t),valid:u,ast:l}),!o&&ae("result.end"),u});return!o&&ae("result",{keyword:Ur,absoluteKeywordLocation:e,instanceLocation:Bt(t),valid:s,ast:e}),!o&&ae("result.end"),s},rs=new Set,ns=(e,t,r,n,o=!1)=>{if(typeof r[e]=="boolean")return r[e]?[]:!1;const s=new Set;for(const[i,,a]of r[e]){if(o&&i==="https://json-schema.org/keyword/unevaluatedProperties")continue;const l=Ce(i),u="collectEvaluatedProperties"in l?l.collectEvaluatedProperties(a,t,r,n,o):l.interpret(a,t,r,n,!0)&&rs;if(u===!1)return!1;u.forEach(Set.prototype.add.bind(s))}return s},os=new Set,ss=(e,t,r,n,o=!1)=>{if(typeof r[e]=="boolean")return r[e]?new Set:!1;const s=new Set;for(const[i,,a]of r[e]){if(o&&i==="https://json-schema.org/keyword/unevaluatedItems")continue;const l=Ce(i),u="collectEvaluatedItems"in l?l.collectEvaluatedItems(a,t,r,n,o):l.interpret(a,t,r,n,!0)&&os;if(u===!1)return!1;u.forEach(Set.prototype.add.bind(s))}return s},c={id:Ur,compile:es,interpret:ts,collectEvaluatedProperties:ns,collectEvaluatedItems:ss},Fe="FLAG",Dr="BASIC",is="DETAILED",Br="VERBOSE";Qo(Fe);const as=async(e,t=void 0,r=void 0)=>{const n=await Pr(e),o=await Lr(n),s=(i,a)=>qr(o,ht(i),a);return t===void 0?s:s(t,r)},Lr=async e=>{const t={metaData:{}},r=await c.compile(e,t);return{ast:t,schemaUri:r}},qr=L(({ast:e,schemaUri:t},r,n=Fe)=>{if(![Fe,Dr,is,Br].includes(n))throw Error(`The '${n}' error format is not supported`);const o=[],s=Cr("result",cs(n,o));try{c.interpret(t,r,e,{})}finally{Ho("result",s)}return o[0]}),cs=(e,t)=>{const r=[];return(n,o)=>{if(n==="result"){const{keyword:s,absoluteKeywordLocation:i,instanceLocation:a,valid:l}=o,u={keyword:s,absoluteKeywordLocation:i,instanceLocation:a,valid:l,errors:[]};r.push(u)}else if(n==="result.start")r.push(n);else if(n==="result.end"){const s=r.pop();for(;r[r.length-1]!=="result.start";){const i=r.pop(),a=[i];e===Dr&&(a.push(...i.errors),delete i.errors),(e===Br||e!==Fe&&!i.valid)&&s.errors.unshift(...a)}r[r.length-1]=s,t[0]=s}}},Le={};Cr("validate.metaValidate",async(e,t)=>{if(!t.document.validated){if(t.document.validated=!0,!(t.document.dialectId in Le)){const o=await Pr(t.document.dialectId),s=await Lr(o);Le[t.document.dialectId]=qr(s)}const r=ht(t.document.root,t.document.baseUri),n=Le[t.document.dialectId](r,Xo());if(!n.valid)throw new Yo(n)}});const ls="https://json-schema.org/keyword/additionalProperties",us=async(e,t,r)=>{const n=j(e.document.dialectId,"https://json-schema.org/keyword/properties"),o=await D(n,r),s=U(o)==="object"?Or(m=>"^"+ds(m)+"$",Ke(o)):Dt(),i=j(e.document.dialectId,"https://json-schema.org/keyword/patternProperties"),a=await D(i,r),l=U(a)==="object"?Ke(a):Dt(),u=k(Vo(s,l),Wo("|"))||"(?!)";return[new RegExp(u,"u"),await c.compile(e,t)]},ds=e=>e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d"),ms=([e,t],r,n,o,s)=>h(r)!=="object"?!0:k(Y(r),se(([i])=>!e.test(i)),q(([,i])=>c.interpret(t,i,n,o,s))),ps=([e,t],r,n,o)=>{if(h(r)!=="object")return!0;const s=new Set;for(const[i,a]of Y(r))if(!e.test(i)){if(!c.interpret(t,a,n,o,!0))return!1;s.add(i)}return s},fs={id:ls,compile:us,interpret:ms,collectEvaluatedProperties:ps},gs="https://json-schema.org/keyword/allOf",hs=(e,t)=>k(J(e),S(r=>c.compile(r,t)),F),ys=(e,t,r,n,o)=>e.every(s=>c.interpret(s,t,r,n,o)),$s=(e,t,r,n)=>e.reduce((o,s)=>{const i=o&&c.collectEvaluatedProperties(s,t,r,n);return i!==!1&&[...o,...i]},[]),ws=(e,t,r,n)=>e.reduce((o,s)=>{const i=o!==!1&&c.collectEvaluatedItems(s,t,r,n);return i!==!1&&new Set([...o,...i])},new Set),As={id:gs,compile:hs,interpret:ys,collectEvaluatedProperties:$s,collectEvaluatedItems:ws},bs={id:"https://json-schema.org/keyword/anchor"},ks="https://json-schema.org/keyword/anyOf",xs=(e,t)=>k(J(e),S(r=>c.compile(r,t)),F),Es=(e,t,r,n,o)=>e.filter(i=>c.interpret(i,t,r,n,o)).length>0,vs=(e,t,r,n)=>e.reduce((o,s)=>{const i=c.collectEvaluatedProperties(s,t,r,n);return i===!1?o:[...o||[],...i]},!1),js=(e,t,r,n)=>e.reduce((o,s)=>{const i=c.collectEvaluatedItems(s,t,r,n);return i===!1?o:new Set([...o||[],...i])},!1),Is={id:ks,compile:xs,interpret:Es,collectEvaluatedProperties:vs,collectEvaluatedItems:js},Ps="https://json-schema.org/keyword/conditional",Ss=(e,t)=>k(J(e),zr,S(r=>c.compile(r,t)),F),Os=(e,t,r,n,o)=>{for(let s=0;s<e.length;s+=2){const i=c.interpret(e[s],t,r,n,o);if(s+1===e.length)return i;if(i)return c.interpret(e[s+1],t,r,n,o)}return!0},Ts=(e,t,r,n)=>{for(let o=0;o<e.length;o+=2){const s=c.collectEvaluatedProperties(e[o],t,r,n);if(o+1===e.length)return s;if(s!==!1)return c.collectEvaluatedProperties(e[o+1],t,r,n)}return new Set},Rs=(e,t,r,n)=>{for(let o=0;o<e.length;o+=2){const s=c.collectEvaluatedItems(e[o],t,r,n);if(o+1===e.length)return s;if(s!==!1)return c.collectEvaluatedItems(e[o+1],t,r,n)}return new Set},zr=async function*(e,t=1){for await(const r of e)t>0&&U(r)==="array"?yield*zr(J(r),t-1):yield r},_s={id:Ps,compile:Ss,interpret:Os,collectEvaluatedProperties:Ts,collectEvaluatedItems:Rs};var Ns=Object.keys,Lt=JSON.stringify;function ye(e,t){var r,n,o,s,i,a,l;if(l=typeof e,l==="string")return Lt(e);if(e===!0)return"true";if(e===!1)return"false";if(e===null)return"null";if(e instanceof Array){for(o="[",n=e.length-1,r=0;r<n;r++)o+=ye(e[r],!1)+",";return n>-1&&(o+=ye(e[r],!1)),o+"]"}if(e instanceof Object){if(typeof e.toJSON=="function")return ye(e.toJSON(),t);for(s=Ns(e).sort(),n=s.length,o="",r=0;r<n;)i=s[r],a=ye(e[i],!0),a!==void 0&&(r&&o!==""&&(o+=","),o+=Lt(i)+":"+a),r++;return"{"+o+"}"}switch(l){case"function":case"undefined":return t?void 0:null;default:return isFinite(e)?e:null}}var Fs=function(e){return""+ye(e,!1)};const ve=Xe(Fs),Cs="https://json-schema.org/keyword/const",Ms=e=>ve(w(e)),Us=(e,t)=>ve(E(t))===e,Ds={id:Cs,compile:Ms,interpret:Us},Bs="https://json-schema.org/keyword/contains",Ls=async(e,t,r)=>{const n=await c.compile(e,t),o=j(e.document.dialectId,"https://json-schema.org/keyword/minContains"),s=await D(o,r),i=U(s)==="number"?w(s):1,a=j(e.document.dialectId,"https://json-schema.org/keyword/maxContains"),l=await D(a,r),u=U(l)==="number"?w(l):Number.MAX_SAFE_INTEGER;return{contains:n,minContains:i,maxContains:u}},Vr=({contains:e,minContains:t,maxContains:r},n,o,s,i)=>{const a=h(n)!=="array"||k(W(n),se(l=>c.interpret(e,l,o,s,i)),_r(l=>l+1,0));return a>=t&&a<=r},qs=(e,t,r,n)=>Vr(e,t,r,n,!0)&&h(t)==="array"&&k(Me(W(t),Ne(0)),se(([o])=>c.interpret(e.contains,o,r,n,!0)),Or(([,o])=>o),Ge),zs={id:Bs,compile:Ls,interpret:Vr,collectEvaluatedItems:qs},Vs=w,Ks=()=>!0,R={compile:Vs,interpret:Ks},Ws={id:"https://json-schema.org/keyword/comment",...R},Gs={id:"https://json-schema.org/keyword/contentEncoding",...R},Js={id:"https://json-schema.org/keyword/contentMediaType",...R},Hs="https://json-schema.org/keyword/contentSchema",Zs=e=>be(e),Xs=()=>!0,Qs={id:Hs,compile:Zs,interpret:Xs},Ys={id:"https://json-schema.org/keyword/default",...R},ei="https://json-schema.org/keyword/definitions",ti=(e,t)=>k(Bo(e),S(r=>c.compile(r,t)),F),ri=()=>!0,ni={id:ei,compile:ti,interpret:ri},oi="https://json-schema.org/keyword/dependentRequired",si=e=>k(Q(e),S(([t,r])=>[t,w(r)]),F),ii=(e,t)=>h(t)!=="object"||e.every(([r,n])=>!de(r,t)||n.every(o=>de(o,t))),ai={id:oi,compile:si,interpret:ii},ci="https://json-schema.org/keyword/dependentSchemas",li=(e,t)=>k(Q(e),S(async([r,n])=>[r,await c.compile(n,t)]),F),ui=(e,t,r,n,o)=>h(t)!=="object"||e.every(([s,i])=>!de(s,t)||c.interpret(i,t,r,n,o)),di=(e,t,r,n)=>{if(h(t)!=="object")return!1;const o=new Set;for(const[s,i]of e)if(de(s,t)){const a=c.collectEvaluatedProperties(i,t,r,n);if(a===!1)return!1;a.forEach(Set.prototype.add.bind(o))}return o},mi={id:ci,compile:li,interpret:ui,collectEvaluatedProperties:di},pi={id:"https://json-schema.org/keyword/deprecated",...R},fi={id:"https://json-schema.org/keyword/description",...R},gi={id:"https://json-schema.org/keyword/dynamicAnchor"},hi="https://json-schema.org/keyword/dynamicRef",yi=async(e,t)=>{const r=w(e),n=await ft(e.document.baseUri,e);return await c.compile(n,t),r},$t=e=>(t,r,n,o,s)=>{if(!(t in o))throw Error(`No dynamic anchor found for "${t}"`);return e(o[t],r,n,o,s)},$i=$t(c.interpret),wi=$t(c.collectEvaluatedProperties),Ai=$t(c.collectEvaluatedItems),bi={id:hi,compile:yi,interpret:$i,collectEvaluatedProperties:wi,collectEvaluatedItems:Ai},ki="https://json-schema.org/keyword/else",xi=async(e,t,r)=>{const n=j(e.document.dialectId,"https://json-schema.org/keyword/if");if(Ir(n,r)){const o=await D(n,r);return[await c.compile(o,t),await c.compile(e,t)]}else return[]},Ei=([e,t],r,n,o,s)=>e===void 0||c.interpret(e,r,n,o,!0)||c.interpret(t,r,n,o,s),vi=([e,t],r,n,o)=>e===void 0||c.interpret(e,r,n,o,!0)?new Set:c.collectEvaluatedProperties(t,r,n,o),ji=([e,t],r,n,o)=>e===void 0||c.interpret(e,r,n,o,!0)?new Set:c.collectEvaluatedItems(t,r,n,o),Ii={id:ki,compile:xi,interpret:Ei,collectEvaluatedProperties:vi,collectEvaluatedItems:ji},Pi="https://json-schema.org/keyword/enum",Si=e=>k(J(e),S(w),S(ve),F),Oi=(e,t)=>e.some(r=>ve(E(t))===r),Ti={id:Pi,compile:Si,interpret:Oi},Ri={id:"https://json-schema.org/keyword/examples",...R},_i="https://json-schema.org/keyword/exclusiveMaximum",Ni=e=>w(e),Fi=(e,t)=>h(t)!=="number"||E(t)<e,Ci={id:_i,compile:Ni,interpret:Fi},Mi="https://json-schema.org/keyword/exclusiveMinimum",Ui=e=>w(e),Di=(e,t)=>h(t)!=="number"||E(t)>e,Bi={id:Mi,compile:Ui,interpret:Di},Li={id:"https://json-schema.org/keyword/format",...R},qi={id:"https://json-schema.org/keyword/id"},zi="https://json-schema.org/keyword/if",Vi=(e,t)=>c.compile(e,t),Ki=(e,t,r,n,o)=>(c.interpret(e,t,r,n,o),!0),Wi=(e,t,r,n)=>c.collectEvaluatedProperties(e,t,r,n)||[],Gi=(e,t,r,n)=>c.collectEvaluatedItems(e,t,r,n)||new Set,Ji={id:zi,compile:Vi,interpret:Ki,collectEvaluatedProperties:Wi,collectEvaluatedItems:Gi},Hi=()=>{const e=B(!1),t=B(!0);return T(e,t),{start:e,end:t}},Zi=e=>{const t=B(!1),r=B(!0);return ra(t,r,e),{start:t,end:r}},Xi=(e,t)=>e===void 0?t:(T(e.end,t.start),e.end.isEnd=!1,{start:e.start,end:t.end}),Qi=(e,t)=>{const r=B(!1);T(r,e.start),T(r,t.start);const n=B(!0);return T(e.end,n),e.end.isEnd=!1,T(t.end,n),t.end.isEnd=!1,{start:r,end:n}},Yi=e=>{const t=B(!1),r=B(!0);return T(t,r),T(t,e.start),T(e.end,r),T(e.end,e.start),e.end.isEnd=!1,{start:t,end:r}},ea=e=>{const t=B(!1),r=B(!0);return T(t,r),T(t,e.start),T(e.end,r),e.end.isEnd=!1,{start:t,end:r}},ta=e=>{const t=B(!1),r=B(!0);return T(t,e.start),T(e.end,r),T(e.end,e.start),e.end.isEnd=!1,{start:t,end:r}},T=(e,t)=>{e.epsilonTransitions.push(t)},ra=(e,t,r)=>{e.transition[r]=t},B=e=>({isEnd:e,transition:{},epsilonTransitions:[]}),na="https://json-schema.org/keyword/itemPattern",Kr=async(e,t)=>{const r=[[]];let n=r[0];for await(const o of J(e))if(U(o)==="string"){const s=w(o);if(s==="*")n.push(Yi(n.pop()));else if(s==="?")n.push(ea(n.pop()));else if(s==="+")n.push(ta(n.pop()));else if(s==="|")n=[],r.push(n);else throw Error(`Unsupported pattern syntax: ${s}`)}else{const s=U(o)==="array"?Kr(o,t):Zi(await c.compile(o,t));n.push(await s)}return gt(e)===0?Hi():r.map(o=>o.reduce(Xi)).reduce(Qi)},wt=e=>(t,r,n,o,s)=>{if(h(r)!=="array")return!0;let i=[];He(t.start,i,[]);for(const a of W(r)){const l=[];for(const u of i){const m=oa(e,u.transition,a,n,o,s);m&&He(m,l,[])}i=l}return!!i.find(a=>a.isEnd)},He=(e,t,r)=>{if(e.epsilonTransitions.length)for(const n of e.epsilonTransitions)r.find(o=>o===n)||(r.push(n),He(n,t,r));else t.push(e)},oa=(e,t,r,n,o,s)=>{for(const i in t)if(e(i,r,n,o,s))return t[i]},sa=wt(c.interpret),ia=wt(c.collectEvaluatedProperties),aa=wt(c.collectEvaluatedItems),ca={id:na,compile:Kr,interpret:sa,collectEvalatedProperties:ia,collectEvalatedItems:aa},la="https://json-schema.org/keyword/items",ua=async(e,t,r)=>{const n=j(e.document.dialectId,"https://json-schema.org/keyword/prefixItems"),o=await D(n,r);return[U(o)==="array"?gt(o):0,await c.compile(e,t)]},Wr=([e,t],r,n,o,s)=>h(r)!=="array"?!0:k(W(r),Tr(e),q(i=>c.interpret(t,i,n,o,s))),da=(e,t,r,n)=>{if(!Wr(e,t,r,n,!0))return!1;const o=new Set;for(let s=e[0];s<ee(t);s++)o.add(s);return o},ma={id:la,compile:ua,interpret:Wr,collectEvaluatedItems:da},pa={id:"https://json-schema.org/keyword/maxContains",...R},fa="https://json-schema.org/keyword/maxItems",ga=e=>w(e),ha=(e,t)=>h(t)!=="array"||ee(t)<=e,ya={id:fa,compile:ga,interpret:ha},$a="https://json-schema.org/keyword/maxLength",wa=e=>w(e),Aa=(e,t)=>h(t)!=="string"||[...E(t)].length<=e,ba={id:$a,compile:wa,interpret:Aa},ka="https://json-schema.org/keyword/maxProperties",xa=e=>w(e),Ea=(e,t)=>h(t)!=="object"||[...yt(t)].length<=e,va={id:ka,compile:xa,interpret:Ea},ja="https://json-schema.org/keyword/maximum",Ia=e=>w(e),Pa=(e,t)=>h(t)!=="number"||E(t)<=e,Sa={id:ja,compile:Ia,interpret:Pa},Oa={id:"https://json-schema.org/keyword/minContains",...R},Ta="https://json-schema.org/keyword/minItems",Ra=e=>w(e),_a=(e,t)=>h(t)!=="array"||ee(t)>=e,Na={id:Ta,compile:Ra,interpret:_a},Fa="https://json-schema.org/keyword/minLength",Ca=e=>w(e),Ma=(e,t)=>h(t)!=="string"||[...E(t)].length>=e,Ua={id:Fa,compile:Ca,interpret:Ma},Da="https://json-schema.org/keyword/minProperties",Ba=e=>w(e),La=(e,t)=>h(t)!=="object"||[...yt(t)].length>=e,qa={id:Da,compile:Ba,interpret:La},za="https://json-schema.org/keyword/minimum",Va=e=>w(e),Ka=(e,t)=>h(t)!=="number"||E(t)>=e,Wa={id:za,compile:Va,interpret:Ka},Ga="https://json-schema.org/keyword/multipleOf",Ja=e=>w(e),Ha=(e,t)=>{if(h(t)!=="number")return!0;const r=E(t)%e;return qt(0,r)||qt(e,r)},qt=(e,t)=>Math.abs(e-t)<11920929e-14,Za={id:Ga,compile:Ja,interpret:Ha},Xa="https://json-schema.org/keyword/not",Qa=c.compile,Ya=(e,t,r,n,o)=>!c.interpret(e,t,r,n,o),ec={id:Xa,compile:Qa,interpret:Ya},tc="https://json-schema.org/keyword/oneOf",rc=(e,t)=>k(J(e),S(r=>c.compile(r,t)),F),nc=(e,t,r,n,o)=>{let s=0;for(const i of e)if(c.interpret(i,t,r,n,o)&&s++,s>1)break;return s===1},oc=(e,t,r,n)=>{let o=0;return e.reduce((s,i)=>{if(o>1)return!1;const a=c.collectEvaluatedProperties(i,t,r,n);return a?o++===0&&a:s},!1)},sc=(e,t,r,n)=>{let o=0;return e.reduce((s,i)=>{if(o>1)return!1;const a=c.collectEvaluatedItems(i,t,r,n);return a?o++===0&&a:s},!1)},ic={id:tc,compile:rc,interpret:nc,collectEvaluatedProperties:oc,collectEvaluatedItems:sc},ac="https://json-schema.org/keyword/pattern",cc=e=>new RegExp(w(e),"u"),lc=(e,t)=>h(t)!=="string"||e.test(E(t)),uc={id:ac,compile:cc,interpret:lc},dc="https://json-schema.org/keyword/patternProperties",mc=(e,t)=>k(Q(e),S(async([r,n])=>[new RegExp(r,"u"),await c.compile(n,t)]),F),pc=(e,t,r,n,o)=>h(t)!=="object"||e.every(([s,i])=>k(Y(t),se(([a])=>s.test(a)),q(([,a])=>c.interpret(i,a,r,n,o)))),fc=(e,t,r,n)=>{if(h(t)!=="object")return!1;const o=new Set;for(const[s,i]of e)for(const[a,l]of Y(t))if(s.test(a)){if(!c.interpret(i,l,r,n,!0))return!1;o.add(a)}return o},gc={id:dc,compile:mc,interpret:pc,collectEvaluatedProperties:fc},hc="https://json-schema.org/keyword/prefixItems",yc=(e,t)=>k(J(e),S(r=>c.compile(r,t)),F),Gr=(e,t,r,n,o)=>h(t)!=="array"||k(Me(e,W(t)),Rr(ee(t)),q(([s,i])=>c.interpret(s,i,r,n,o))),$c=(e,t,r,n)=>Gr(e,t,r,n,!0)&&new Set(e.map((o,s)=>s)),wc={id:hc,compile:yc,interpret:Gr,collectEvaluatedItems:$c},Ac="https://json-schema.org/keyword/properties",bc=(e,t)=>k(Q(e),S(async([r,n])=>[r,await c.compile(n,t)]),Je),kc=(e,t,r,n,o)=>h(t)!=="object"||k(Y(t),se(([s])=>s in e),q(([s,i])=>c.interpret(e[s],i,r,n,o))),xc=(e,t,r,n)=>{if(h(t)!=="object")return!1;const o=new Set;for(const[s,i]of Y(t))if(s in e){if(!c.interpret(e[s],i,r,n,!0))return!1;o.add(s)}return o},Ec={id:Ac,compile:bc,interpret:kc,collectEvaluatedProperties:xc},vc="https://json-schema.org/keyword/propertyDependencies",jc=(e,t)=>k(Q(e),S(async([r,n])=>[r,await k(Q(n),S(async([o,s])=>[o,await c.compile(s,t)]),Je)]),Je),Ic=(e,t,r,n,o)=>h(t)!=="object"||Object.entries(e).every(([s,i])=>{const a=E(t)[s];return!de(s,t)||!(a in i)||c.interpret(i[a],t,r,n,o)}),Pc=(e,t,r,n)=>Object.entries(e).reduce((o,[s,i])=>{const a=E(t)[s];if(de(s,t)&&a in i){const l=c.collectEvaluatedProperties(i[a],t,r,n);return l!==!1&&o.concat(l)}else return o},[]),Sc={id:vc,compile:jc,interpret:Ic,collectEvaluatedProperties:Pc},Oc="https://json-schema.org/keyword/propertyNames",Tc=(e,t)=>c.compile(e,t),Rc=(e,t,r,n)=>h(t)!=="object"||q(o=>c.interpret(e,ht(o),r,n,!0),yt(t)),_c={id:Oc,compile:Tc,interpret:Rc},Nc={id:"https://json-schema.org/keyword/readOnly",...R},Fc="https://json-schema.org/keyword/ref",Cc=c.compile,Mc=c.interpret,Uc=c.collectEvaluatedProperties,Dc=c.collectEvaluatedItems,Bc={id:Fc,compile:Cc,interpret:Mc,collectEvaluatedProperties:Uc,collectEvaluatedItems:Dc},Lc="https://json-schema.org/keyword/requireAllExcept",qc=async(e,t,r)=>{const n=await w(e),o=j(e.document.dialectId,"https://json-schema.org/keyword/properties"),s=await D(o,r),i=U(s)==="object"?Ke(s):[],a=new Set(i);return n.forEach(l=>i.remove(l)),[...a]},zc=(e,t)=>h(t)!=="object"||e.every(r=>Object.hasOwn(E(t),r)),Vc={id:Lc,compile:qc,interpret:zc},Kc="https://json-schema.org/keyword/required",Wc=e=>w(e),Gc=(e,t)=>h(t)!=="object"||e.every(r=>Object.hasOwn(E(t),r)),Jc={id:Kc,compile:Wc,interpret:Gc},Hc={id:"https://json-schema.org/keyword/title",...R},Zc="https://json-schema.org/keyword/then",Xc=async(e,t,r)=>{const n=j(e.document.dialectId,"https://json-schema.org/keyword/if");if(Ir(n,r)){const o=await D(n,r);return[await c.compile(o,t),await c.compile(e,t)]}else return[]},Qc=([e,t],r,n,o,s)=>e===void 0||!c.interpret(e,r,n,o,!0)||c.interpret(t,r,n,o,s),Yc=([e,t],r,n,o)=>e===void 0||!c.interpret(e,r,n,o,!0)?new Set:c.collectEvaluatedProperties(t,r,n,o),el=([e,t],r,n,o)=>e===void 0||!c.interpret(e,r,n,o,!0)?new Set:c.collectEvaluatedItems(t,r,n,o),tl={id:Zc,compile:Xc,interpret:Qc,collectEvaluatedProperties:Yc,collectEvaluatedItems:el},rl="https://json-schema.org/keyword/type",nl=e=>w(e),ol=(e,t)=>typeof e=="string"?zt(t)(e):e.some(zt(t)),zt=e=>t=>t==="integer"?h(e)==="number"&&Number.isInteger(E(e)):h(e)===t,sl={id:rl,compile:nl,interpret:ol},il="https://json-schema.org/keyword/unevaluatedItems",al=async(e,t,r)=>[be(r),await c.compile(e,t)],cl=([e,t],r,n,o,s)=>{if(h(r)!=="array")return!0;const i=c.collectEvaluatedItems(e,r,n,o,!0);return i===!1||k(Me(W(r),Ne(0)),se(([,a])=>!i.has(a)),q(([a])=>c.interpret(t,a,n,o,s)))},ll=(e,t,r,n)=>{const o=c.collectEvaluatedItems(e[0],t,r,n,!0);if(!o)return!1;const s=new Set;for(let i=0;i<ee(t);i++)o.has(i)||s.add(i);return s},ul={id:il,compile:al,interpret:cl,collectEvaluatedItems:ll},dl="https://json-schema.org/keyword/unevaluatedProperties",ml=async(e,t,r)=>[be(r),await c.compile(e,t)],pl=([e,t],r,n,o,s)=>{if(h(r)!=="object")return!0;const i=c.collectEvaluatedProperties(e,r,n,o,!0);return!i||k(Y(r),se(([a])=>!i.has(a)),q(([,a])=>c.interpret(t,a,n,o,s)))},fl=([e,t],r,n,o)=>{if(h(r)!=="object")return!0;const s=c.collectEvaluatedProperties(e,r,n,o,!0);if(!s)return!1;for(const[i,a]of Y(r))if(!s.has(i)){if(!c.interpret(t,a,n,o,!0))return!1;s.add(i)}return s},gl={id:dl,compile:ml,interpret:pl,collectEvaluatedProperties:fl},hl="https://json-schema.org/keyword/uniqueItems",yl=e=>w(e),$l=(e,t)=>{if(h(t)!=="array"||e===!1)return!0;const r=E(t).map(ve);return new Set(r).size===r.length},wl={id:hl,compile:yl,interpret:$l},Al={id:"https://json-schema.org/keyword/unknown",...R},bl={id:"https://json-schema.org/keyword/vocabulary"},kl={id:"https://json-schema.org/keyword/writeOnly",...R};kr("application/schema+json",qo);d(fs);d(As);d(bs);d(Is);d(_s);d(Ds);d(zs);d(Ws);d(Gs);d(Js);d(Qs);d(Ys);d(ni);d(ai);d(mi);d(pi);d(fi);d(gi);d(bi);d(Ii);d(Ti);d(Ri);d(Ci);d(Bi);d(Li);d(qi);d(Ji);d(ma);d(pa);d(ya);d(ba);d(va);d(Sa);d(Oa);d(Na);d(Ua);d(qa);d(Wa);d(Za);d(ec);d(ic);d(uc);d(gc);d(wc);d(Ec);d(Sc);d(_c);d(Nc);d(Bc);d(Vc);d(Jc);d(ca);d(Hc);d(tl);d(sl);d(ul);d(gl);d(wl);d(Al);d(bl);d(kl);const xl={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},writeOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0},El="https://json-schema.org/keyword/draft-04/additionalItems",vl=async(e,t,r)=>{const n=j(e.document.dialectId,"https://json-schema.org/keyword/draft-04/items"),o=await D(n,r);return[U(o)==="array"?gt(o):Number.MAX_SAFE_INTEGER,await c.compile(e,t)]},Jr=([e,t],r,n,o,s)=>h(r)!=="array"?!0:k(W(r),Tr(e),q(i=>c.interpret(t,i,n,o,s))),jl=(e,t,r,n)=>{if(!Jr(e,t,r,n))return!1;const o=new Set;for(let s=e[0];s<ee(t);s++)o.add(s);return o},Il={id:El,compile:vl,interpret:Jr,collectEvaluatedItems:jl},Pl="https://json-schema.org/keyword/draft-06/contains",Sl=(e,t)=>c.compile(e,t),Ol=(e,t,r,n,o)=>h(t)!=="array"||Ko(s=>c.interpret(e,s,r,n,o),W(t)),Tl={id:Pl,compile:Sl,interpret:Ol},Rl="https://json-schema.org/keyword/draft-04/dependencies",_l=(e,t)=>k(Q(e),S(async([r,n])=>[r,U(n)==="array"?w(n):await c.compile(n,t)]),F),Nl=(e,t,r,n,o)=>{const s=E(t);return h(t)!=="object"||e.every(([i,a])=>i in s?Array.isArray(a)?a.every(l=>l in s):c.interpret(a,t,r,n,o):!0)},Fl={id:Rl,compile:_l,interpret:Nl},Cl="https://json-schema.org/keyword/draft-04/items",Ml=(e,t)=>U(e)==="array"?k(J(e),S(r=>c.compile(r,t)),F):c.compile(e,t),Hr=(e,t,r,n,o)=>h(t)!=="array"?!0:typeof e=="string"?q(s=>c.interpret(e,s,r,n,o),W(t)):k(Me(e,W(t)),Rr(ee(t)),q(([s,i])=>c.interpret(s,i,r,n,o))),Ul=(e,t,r,n)=>Hr(e,t,r,n)&&Ge(typeof e=="string"?Ne(0,ee(t)):Ne(0,e.length)),Dl={id:Cl,compile:Ml,interpret:Hr,collectEvaluatedItems:Ul},Bl={id:"https://json-schema.org/keyword/draft-04/id"},Ll={id:"https://json-schema.org/keyword/draft-04/ref"};d(Il);d(Tl);d(Fl);d(Bl);d(Dl);d(Ll);const Ze="http://json-schema.org/draft-07/schema";yo(Ze,{$id:"https://json-schema.org/keyword/draft-04/id",$ref:"https://json-schema.org/keyword/draft-04/ref",$comment:"https://json-schema.org/keyword/comment",additionalItems:"https://json-schema.org/keyword/draft-04/additionalItems",additionalProperties:"https://json-schema.org/keyword/additionalProperties",allOf:"https://json-schema.org/keyword/allOf",anyOf:"https://json-schema.org/keyword/anyOf",const:"https://json-schema.org/keyword/const",contains:"https://json-schema.org/keyword/draft-06/contains",default:"https://json-schema.org/keyword/default",definitions:"https://json-schema.org/keyword/definitions",dependencies:"https://json-schema.org/keyword/draft-04/dependencies",description:"https://json-schema.org/keyword/description",enum:"https://json-schema.org/keyword/enum",exclusiveMaximum:"https://json-schema.org/keyword/exclusiveMaximum",exclusiveMinimum:"https://json-schema.org/keyword/exclusiveMinimum",format:"https://json-schema.org/keyword/format",if:"https://json-schema.org/keyword/if",then:"https://json-schema.org/keyword/then",else:"https://json-schema.org/keyword/else",items:"https://json-schema.org/keyword/draft-04/items",maxItems:"https://json-schema.org/keyword/maxItems",maxLength:"https://json-schema.org/keyword/maxLength",maxProperties:"https://json-schema.org/keyword/maxProperties",maximum:"https://json-schema.org/keyword/maximum",minItems:"https://json-schema.org/keyword/minItems",minLength:"https://json-schema.org/keyword/minLength",minProperties:"https://json-schema.org/keyword/minProperties",minimum:"https://json-schema.org/keyword/minimum",multipleOf:"https://json-schema.org/keyword/multipleOf",not:"https://json-schema.org/keyword/not",oneOf:"https://json-schema.org/keyword/oneOf",pattern:"https://json-schema.org/keyword/pattern",patternProperties:"https://json-schema.org/keyword/patternProperties",properties:"https://json-schema.org/keyword/properties",propertyNames:"https://json-schema.org/keyword/propertyNames",readOnly:"https://json-schema.org/keyword/readOnly",required:"https://json-schema.org/keyword/required",title:"https://json-schema.org/keyword/title",type:"https://json-schema.org/keyword/type",uniqueItems:"https://json-schema.org/keyword/uniqueItems",writeOnly:"https://json-schema.org/keyword/writeOnly"});wr(Ze,{[Ze]:!0},!0);Sr(xl);const ql="http://json-schema.org/draft-07/schema#",zl="https://frederikb.github.io/bookmarksync/schemas/bookmarks.1-0-0.schema.json",Vl="Bookmarks",Kl="A named collection of bookmarks as used in a web browser",Wl="object",Gl=!1,Jl={$schema:{type:"string",format:"uri",enum:["https://frederikb.github.io/bookmarksync/schemas/bookmarks.1-0-0.schema.json"],description:"The URI of this exact JSON schema"},name:{type:"string",description:"Name of the bookmark collection."},bookmarks:{type:"array",items:{$ref:"#/definitions/bookmarkItem"},description:"Array of bookmarks, separators or folders."}},Hl=["name","bookmarks"],Zl={bookmarkItem:{type:"object",properties:{title:{type:"string",description:"Title of the bookmark or folder. Required unless 'type' is 'separator'."},url:{type:"string",format:"uri",description:"URL of the bookmark. Only for bookmarks."},children:{type:"array",items:{$ref:"#/definitions/bookmarkItem"},description:"Nested bookmarks or folders. Only for folders."},type:{type:"string",enum:["folder","bookmark","separator"],description:"Type of the item. If absent, inferred from properties."}},allOf:[{if:{required:["type"],properties:{type:{const:"separator"}}},then:{properties:{title:!1,url:!1,children:!1}}},{if:{required:["type"],properties:{type:{const:"bookmark"}}},then:{required:["url","title"],properties:{children:!1}}},{if:{required:["type"],properties:{type:{const:"folder"}}},then:{required:["children"],properties:{url:!1}}},{if:{properties:{type:!1}},then:{required:["title"],oneOf:[{required:["url"],properties:{children:!1}},{required:["children"],properties:{url:!1}}]}}]}},Xl={$schema:ql,$id:zl,title:Vl,description:Kl,type:Wl,additionalProperties:Gl,properties:Jl,required:Hl,definitions:Zl};Sr(Xl);var le;class Ql{constructor(t){je(this,le,void 0);Ie(this,le,t)}async synchronizeBookmarks(t=!1){try{console.log(`Starting ${t?"forced ":""}bookmark synchronization`);const r=await he(this,le).load({force:t});if(r){await Vt(r);const n=r.flatMap(s=>s.bookmarks),o=Yl(n);await eu(o),await ce("Bookmarks synchronized","Your bookmarks have been updated."),console.log("Bookmarks synchronized")}}catch(r){r instanceof sn?console.log("Could not sync because the required configuration values are not set"):r instanceof on?(console.error("Authentication error:",r.message,r.originalError),await ce("Authentication failed",r.message)):r instanceof an?(console.error("Data not found error:",r.message,r.originalError),await ce("Data not found",r.message)):r instanceof Wt?(console.error("Bookmark data not valid error:",r.message),await ce("Invalid bookmark data",`Canceling synchronization: ${r.message}`)):r instanceof cn?(console.error("Repository not found error:",r.message),await ce("Repo not found",r.message)):(console.error("Error during synchronization:",r),await ce("Synchronization failed","Failed to update bookmarks."))}}async validateBookmarks(){console.log("Validating the configured source of bookmarks");const t=await he(this,le).load({force:!0,cacheEtag:!1});await Vt(t)}}le=new WeakMap;const[iu,au]=Nn("SyncBookmarksService",e=>new Ql(e));async function Vt(e){const r=await as("https://frederikb.github.io/bookmarksync/schemas/bookmarks.1-0-0.schema.json");for(const n of e)if(!r(n).valid){const s=n.name||"<name not defined>";throw new Wt(`The bookmarks file with name '${s}' is not valid`)}}function Yl(e){return Array.from(new Map(e.map(t=>[t.title,t])).values())}async function eu(e){const t=tu();if(!t)throw new Error("Bookmarks Bar not found");const r=await ru(t);for(const n of e)await nu(t,n,r)}function tu(){return"1"}async function ru(e){return(await Z.bookmarks.getChildren(e)).reduce((r,n)=>r.set(n.title,n),new Map)}async function nu(e,t,r){const n=r.get(t.title);n&&await(n.url?Z.bookmarks.remove(n.id):Z.bookmarks.removeTree(n.id));const o=await Z.bookmarks.create({parentId:e,title:t.title,url:t.url});!t.url&&t.children&&await Zr(o.id,t.children)}async function Zr(e,t){for(const r of t)if(r.type==="folder"||r.children){const n=await Z.bookmarks.create({parentId:e,title:r.title});await Zr(n.id,r.children)}else r.type==="separator"||await Z.bookmarks.create({parentId:e,title:r.title,url:r.url})}async function ce(e,t,r="basic"){const n=`sync-bookmarks-notification-${Date.now()}`;return Z.notifications.create(n,{type:r,iconUrl:Z.runtime.getURL("/icon/128.png"),title:e,message:t})}export{on as A,re as B,an as D,cn as R,su as a,sn as b,rn as c,au as d,Z as e,Xe as g,iu as r};
